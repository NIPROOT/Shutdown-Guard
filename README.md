# Shutdown Guard üîå

> A professional, cross-platform utility to schedule automatic PC shutdowns with voice alerts, email notifications, and detailed system monitoring.

---

## üìå Table of Contents

- [Introduction](#introduction)  
- [Features](#features)  
- [Technologies](#technologies)  
- [Installation](#installation)  
- [Usage](#usage)  
- [Configuration](#configuration)  
- [Supported Operating Systems](#supported-operating-systems)  
- [Packaging (Creating Executables)](#packaging-creating-executables)  
- [Security Considerations](#security-considerations)  
- [Troubleshooting](#troubleshooting)  
- [Project Structure](#project-structure)  
- [Contributing](#contributing)  
- [License](#license)  
- [Contact & Author](#contact--author)  

---

## Introduction

Shutdown Guard is designed to help you **automate your computer shutdown safely and reliably**, protecting your system from unexpected power loss or ensuring it powers off at a scheduled time.  
It features:

- A sleek **PyQt5 GUI** with dark theme  
- Real-time **system information monitoring** (CPU, memory, disk, network, battery, uptime)  
- Configurable **shutdown scheduling** with countdown and voice alerts  
- **Email notifications** 5 minutes before shutdown (via Gmail SMTP with app password)  
- Cross-platform compatibility: **Windows, Linux, macOS**  
- Optional packaging into standalone executables for easy distribution  

---

## Features

- **User-friendly GUI** with tabs: System Info, Shutdown Time, Email Settings, About  
- **Detailed system stats:** OS info, uptime, CPU (usage & frequency), memory, disk usage, network interfaces and IPs, battery status  
- **Voice notifications** powered by `pyttsx3` (offline TTS)  
- **Email alerts** sent automatically before shutdown  
- **Automated shutdown** at scheduled time, with countdown voice prompts  
- **Background scheduling** runs silently after setup  
- **Cross-platform shutdown commands** for wide OS support  
- **Installer script** to compile Python scripts into silent `.exe` files (Windows)  

---

## Technologies

- Python 3.7+  
- [PyQt5](https://pypi.org/project/PyQt5/) for GUI  
- [psutil](https://pypi.org/project/psutil/) for system monitoring  
- [pyttsx3](https://pypi.org/project/pyttsx3/) for text-to-speech alerts  
- [smtplib](https://docs.python.org/3/library/smtplib.html) for SMTP email sending  
- [requests](https://pypi.org/project/requests/) for external IP detection  
- [pytz](https://pypi.org/project/pytz/) for timezone handling  
- [PyInstaller](https://www.pyinstaller.org/) for packaging executables  

---

## Installation

### 1. Prerequisites

- Python 3.7 or higher installed  
- Recommended: a virtual environment (e.g., `venv` or `conda`)  

### 2. Install dependencies

Run the following command in your terminal or command prompt:

```bash
pip install pyqt5 psutil pyttsx3 requests pytz
```

Make sure your Python's `Scripts` directory is in your PATH to use tools like `pyinstaller`.

---

## Usage

### Running the GUI app

From the project root directory:

```bash
python gui.py
```

- On startup, the app will open your default browser to the author's website and greet you with a voice message.  
- Navigate through tabs to configure system info view, shutdown time, and email alerts.

### Scheduling shutdown

1. Go to **Shutdown Time** tab  
2. Pick a time (24-hour format) using the time picker  
3. Click **Save Time** to store the schedule and start the scheduler  

### Email Alerts

1. Go to **Email Settings** tab  
2. Enter:
   - Sender Gmail address (your Gmail account)  
   - App password (see next section)  
   - Recipient email address (where to send alerts)  
3. Click **Save Email Settings**  

**Note:** Email alert will be sent 5 minutes before shutdown.

---

## Configuration

- `shutdown_time.txt`: Stores the scheduled shutdown time in `HH:mm` format (auto-generated by GUI).  
- `email_settings.txt`: Stores the sender email, app password, and receiver email, each on its own line.

**Important:** Never share `email_settings.txt` as it contains sensitive credentials.

---

## Supported Operating Systems

| OS       | Shutdown Command Used         | Tested  |
| -------- | ---------------------------- | ------- |
| Windows  | `shutdown /s /t 0`           | ‚úîÔ∏è      |
| Linux    | `shutdown -h now`            | ‚úîÔ∏è      |
| macOS    | `sudo shutdown -h now`       | ‚úîÔ∏è      |

*Note: On macOS, you might be prompted for your password.*

---

## Packaging (Creating Executables)

For Windows users, there's an installer script to:

- Compile the Python scripts (`gui.py` and `offing.py`) into standalone executables  
- Copy the GUI executable to the Windows Start Menu for easy access  
- Run the GUI silently after installation  

### Steps:

1. Install PyInstaller if not already:

```bash
pip install pyinstaller
```

2. Run the installer script:

```bash
python installer.py
```

After that, you can launch the app from the Start Menu.

---

## Security Considerations

- Use **Gmail App Passwords** (not your main Gmail password) for SMTP email login.  
  See: [Google's App Passwords](https://support.google.com/accounts/answer/185833)  
- Avoid storing passwords in plaintext on shared or public machines.  
- Be cautious about allowing shutdowns remotely; ensure only trusted users have access.  
- Keep your Python environment and dependencies updated to avoid vulnerabilities.

---

## Troubleshooting

- **Voice alerts don't work:**  
  - Ensure `pyttsx3` is installed and configured correctly.  
  - Check audio output device on your system.

- **Email alerts fail to send:**  
  - Double-check your Gmail address and app password.  
  - Verify internet connectivity.  
  - Ensure Gmail SMTP is not blocked.

- **Shutdown command not working:**  
  - Verify OS detection by `platform.system()` is correct.  
  - On Linux/macOS, you may need sudo privileges for shutdown commands.

- **GUI doesn't start or crashes:**  
  - Confirm PyQt5 and dependencies installed correctly.  
  - Run the script in a terminal to see error messages.

---

## Project Structure

```plaintext
‚îú‚îÄ‚îÄ gui.py               # Main graphical interface and app logic
‚îú‚îÄ‚îÄ offing.py            # Background scheduler script for shutdown and alerts
‚îú‚îÄ‚îÄ installer.py         # Script to build executables and setup Start Menu (Windows)
‚îú‚îÄ‚îÄ email_settings.txt   # Saved email config (created by GUI)
‚îú‚îÄ‚îÄ shutdown_time.txt    # Saved shutdown schedule (created by GUI)
‚îú‚îÄ‚îÄ power.png            # Icon for the app window
‚îú‚îÄ‚îÄ README.md            # This documentation file
‚îú‚îÄ‚îÄ LICENSE              # License file (MIT)
```

---

## Contributing

Contributions, bug reports, and feature requests are warmly welcome!  

1. Fork the repository  
2. Create your feature branch (`git checkout -b feature/new-feature`)  
3. Commit your changes (`git commit -m 'Add new feature'`)  
4. Push to the branch (`git push origin feature/new-feature`)  
5. Open a pull request  

---

## License

This project is licensed under the **MIT License** ‚Äî see the [LICENSE](LICENSE) file for details.

---

## Contact & Author

Developed by **Niproot**  
Website: [niproot.freehost.io](https://niproot.freehost.io)  
GitHub: [github.com/niproot](https://github.com/niproot)  

---

Thank you for using **Shutdown Guard**!  
Stay safe and keep your data protected. ‚ö°üíª

